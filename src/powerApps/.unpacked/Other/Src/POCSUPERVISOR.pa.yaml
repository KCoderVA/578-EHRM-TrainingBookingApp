# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  POCSUPERVISOR:
    Properties:
      Fill: =RGBA(236, 236, 236, 1)
      Height: =Max(App.Height, App.DesignHeight)
      Width: =Max(App.Width, App.DesignWidth)
    Children:
      - Label16:
          Control: Label@2.5.1
          Properties:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(168, 0, 0, 1)
            FontWeight: =FontWeight.Bold
            Height: =104
            Text: |-
              ="Fields marked with an asterisk ( * ) are required to be filled out.
              You may not proceed until you provide an answer to all required questions!"
            Visible: |-
              =If(
                  btnContinueDate_1.DisplayMode = DisplayMode.Disabled,
                  true,
                  false
              )
            Width: =1136
            Y: =536
      - Form1:
          Control: Form@2.4.4
          Variant: Classic
          Layout: Vertical
          Properties:
            DataSource: ='Desk Reservations'
            DefaultMode: =FormMode.New
            Height: =373
            NumberOfColumns: =2
            Width: =1136
            Y: =165
          Children:
            - Reserved By_DataCard1:
                Control: TypedDataCard@1.0.7
                Variant: ClassicComboBoxEdit
                Properties:
                  DataField: ="ReservedBy"
                  Default: =ThisItem.'Reserved By'
                  DisplayName: =DataSourceInfo([@'Desk Reservations'],DataSourceInfo.DisplayName,'Reserved By')
                  Height: =95
                  Required: =true
                  Update: =DataCardValue3.Selected
                  Width: =568
                  X: =0
                  Y: =0
                Children:
                  - DataCardKey3:
                      Control: Label@2.5.1
                      MetadataKey: FieldName
                      Properties:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =App.Theme.Colors.Darker30
                        Height: =48
                        Size: =16
                        Text: ="The EMPLOYEE I am creating a reservation for is:"
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =21
                  - ErrorMessage3:
                      Control: Label@2.5.1
                      MetadataKey: ErrorMessage
                      Properties:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =RGBA(168, 0, 0, 1)
                        FontWeight: =FontWeight.Semibold
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =24
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue3.Y + DataCardValue3.Height
                  - StarVisible3:
                      Control: Label@2.5.1
                      MetadataKey: FieldRequired
                      Properties:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =Color.Red // App.Theme.Colors.Darker30
                        FontWeight: =FontWeight.Bold
                        Height: =DataCardKey3.Height
                        Size: =30
                        Text: ="*"
                        Visible: |-
                          =If(
                              And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit, IsBlank(DataCardValue3)),
                              true,
                              false
                          )
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey3.Y
                  - DataCardValue3:
                      Control: Classic/ComboBox@2.4.0
                      Properties:
                        DefaultSelectedItems: |-
                          ={
                              Claims: "i:0#.f|membership|" & Office365Users.MyProfileV2().userPrincipalName,
                              DisplayName: Office365Users.MyProfileV2().displayName,
                              Email: Office365Users.MyProfileV2().mail
                          }
                        DisplayFields: =["DisplayName","Email","Picture"]
                        DisplayMode: =Parent.DisplayMode
                        FontWeight: =FontWeight.Bold
                        Height: =45
                        InputTextPlaceholder: ="Find people..."
                        Items: =Choices([@'Desk Reservations'].'Reserved By')
                        PaddingBottom: =5
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PaddingRight: =5
                        PaddingTop: =5
                        SearchFields: =["Claims"]
                        SelectMultiple: =false
                        Size: =14
                        Tooltip: =Parent.DisplayName
                        Width: =508
                        X: =35
                        Y: =DataCardKey3.Y + DataCardKey3.Height + 5
            - Manager_DataCard1:
                Control: TypedDataCard@1.0.7
                Variant: ClassicComboBoxEdit
                Properties:
                  DataField: ="Manager"
                  Default: =ThisItem.Manager
                  DisplayName: =DataSourceInfo([@'Desk Reservations'],DataSourceInfo.DisplayName,Manager)
                  Height: =95
                  Required: =true
                  Update: =DataCardValue7.Selected
                  Width: =568
                  X: =1
                  Y: =0
                Children:
                  - DataCardKey9:
                      Control: Label@2.5.1
                      MetadataKey: FieldName
                      Properties:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =App.Theme.Colors.Darker30
                        Height: =48
                        Size: =16
                        Text: ="The selected employee's SUPERVISOR is:"
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =21
                  - DataCardValue7:
                      Control: Classic/ComboBox@2.4.0
                      MetadataKey: FieldValue
                      Properties:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        DefaultSelectedItems: |-
                          =With(
                              {
                                  // Step 1: Get the manager profile based on the email of the user selected in the first dropdown.
                                  managerProfile: Office365Users.ManagerV2(DataCardValue3.Selected.Email)
                              },
                              // Step 2: If a manager is found, build the record in the format your combobox expects.
                              If(
                                  !IsBlank(managerProfile.id),
                                  {
                                      Claims: "i:0#.f|membership|" & managerProfile.mail,
                                      DisplayName: managerProfile.displayName,
                                      Email: managerProfile.mail
                                  }
                              )
                          )
                        DisplayFields: =["DisplayName","Email","Picture"]
                        DisplayMode: =Parent.DisplayMode
                        FontWeight: =FontWeight.Bold
                        Height: =DataCardValue3.Height
                        InputTextPlaceholder: ="Last Name, First Name "
                        Items: =Choices([@'Desk Reservations'].Manager)
                        PaddingBottom: =5
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PaddingRight: =5
                        PaddingTop: =5
                        SearchFields: =["DisplayName"]
                        SelectMultiple: =false
                        Size: =14
                        Tooltip: =Parent.DisplayName
                        Width: =DataCardValue3.Width
                        X: =35
                        Y: =DataCardKey9.Y + DataCardKey9.Height + 5
                  - ErrorMessage9:
                      Control: Label@2.5.1
                      MetadataKey: ErrorMessage
                      Properties:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =RGBA(168, 0, 0, 1)
                        FontWeight: =FontWeight.Semibold
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =24
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue7.Y + DataCardValue7.Height
                  - StarVisible9:
                      Control: Label@2.5.1
                      MetadataKey: FieldRequired
                      Properties:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =Color.Red // App.Theme.Colors.Darker30
                        FontWeight: =FontWeight.Bold
                        Height: =DataCardKey9.Height
                        Size: =30
                        Text: ="*"
                        Visible: |-
                          =If(
                              And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit, IsBlank(DataCardValue7)),
                              true,
                              false
                          )
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey9.Y
            - Service_DataCard1:
                Control: TypedDataCard@1.0.7
                Variant: ClassicTextualEdit
                Properties:
                  DataField: ="Service"
                  Default: =ThisItem.Service
                  DisplayName: =DataSourceInfo([@'Desk Reservations'],DataSourceInfo.DisplayName,Service)
                  Height: =93
                  MaxLength: =DataSourceInfo([@'Desk Reservations'], DataSourceInfo.MaxLength, Service)
                  Required: =true
                  Update: =DataCardValue8.Text
                  Width: =568
                  X: =0
                  Y: =1
                Children:
                  - DataCardKey10:
                      Control: Label@2.5.1
                      MetadataKey: FieldName
                      Properties:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =App.Theme.Colors.Darker30
                        Height: =48
                        Size: =16
                        Text: ="The selected employee's SERVICE LINE/TEAM is:"
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =28
                  - DataCardValue8:
                      Control: Classic/TextInput@2.3.2
                      MetadataKey: FieldValue
                      Properties:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        Default: |-
                          =If(
                              !IsBlank(DataCardValue3),
                                  If(
                                      IsBlank(Office365Users.UserProfileV2(DataCardValue3.Selected.Email).department),
                                      "",
                                      Office365Users.UserProfileV2(DataCardValue3.Selected.Email).department & ", "
                                      )
                                  & If(
                                      IsBlank(Office365Users.UserProfileV2(DataCardValue3.Selected.Email).officeLocation),
                                      "",
                                      Office365Users.UserProfileV2(DataCardValue3.Selected.Email).officeLocation & ", "
                                      )
                              & If(
                                      IsBlank(Office365Users.UserProfileV2(DataCardValue3.Selected.Email).companyName),
                                      "",
                                      Office365Users.UserProfileV2(DataCardValue3.Selected.Email).companyName & ";"
                                  ),
                              // DataCardValue3.Selected.Department,
                              Parent.Default
                          )
                        DelayOutput: =true
                        DisplayMode: =Parent.DisplayMode
                        FontWeight: =FontWeight.Bold
                        Height: |-
                          =If(
                              Len(Self.Text) > 30,
                              DataCardValue3.Height * 1.3,
                              DataCardValue3.Height 
                          )
                        HintText: ="Required"
                        MaxLength: =Parent.MaxLength * 2
                        Mode: =TextMode.MultiLine
                        PaddingLeft: =5
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =14
                        Tooltip: =Parent.DisplayName
                        Width: =DataCardValue3.Width
                        X: =35
                        Y: =DataCardKey10.Y + DataCardKey10.Height + 5
                  - ErrorMessage10:
                      Control: Label@2.5.1
                      MetadataKey: ErrorMessage
                      Properties:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =RGBA(168, 0, 0, 1)
                        FontWeight: =FontWeight.Semibold
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =24
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue8.Y + DataCardValue8.Height
                  - StarVisible10:
                      Control: Label@2.5.1
                      MetadataKey: FieldRequired
                      Properties:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =Color.Red // App.Theme.Colors.Darker30
                        FontWeight: =FontWeight.Bold
                        Height: =DataCardKey10.Height
                        Size: =30
                        Text: ="*"
                        Visible: |-
                          =If(
                              And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit, IsBlank(DataCardValue8)),
                              true,
                              false
                          )
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey10.Y
            - Meeting Catagory_DataCard1:
                Control: TypedDataCard@1.0.7
                Variant: ClassicComboBoxEdit
                Properties:
                  DataField: ="MeetingCatagory"
                  DisplayName: =DataSourceInfo([@'Desk Reservations'],DataSourceInfo.DisplayName)
                  Height: =85
                  Required: =true
                  Update: =DropdownCanvas1.Selected
                  Width: =568
                  X: =1
                  Y: =1
                Children:
                  - DataCardKey13:
                      Control: Label@2.5.1
                      MetadataKey: FieldName
                      Properties:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =App.Theme.Colors.Darker30
                        Height: =48
                        Size: =16
                        Text: ="The TRAINING the selected employee needs is:"
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =21
                  - ErrorMessage13:
                      Control: Label@2.5.1
                      MetadataKey: ErrorMessage
                      Properties:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =RGBA(168, 0, 0, 1)
                        FontWeight: =FontWeight.Semibold
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =24
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DropdownCanvas1.Y + DropdownCanvas1.Height
                  - StarVisible13:
                      Control: Label@2.5.1
                      MetadataKey: FieldRequired
                      Properties:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =Color.Red // App.Theme.Colors.Darker30
                        FontWeight: =FontWeight.Bold
                        Height: =DataCardKey13.Height
                        Size: =30
                        Text: ="*"
                        Visible: |-
                          =If(
                              And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit, !IsBlank(DropdownCanvas1)),
                              true,
                              false
                          )
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey13.Y
                  - DropdownCanvas1:
                      Control: Classic/ComboBox@2.4.0
                      Properties:
                        DisplayFields: =["Value"]
                        FontWeight: =FontWeight.Bold
                        Height: =DataCardValue3.Height
                        IsSearchable: =false
                        Items: =["Super User Training", "End User Training"]
                        PaddingBottom: =5
                        PaddingLeft: =5
                        PaddingRight: =5
                        PaddingTop: =5
                        SearchFields: =["Value"]
                        SelectMultiple: =false
                        Size: =14
                        Width: =DataCardValue3.Width
                        X: =35
                        Y: =DataCardKey13.Y + DataCardKey13.Height + 5
            - Reason for desk reservation_DataCard1:
                Control: TypedDataCard@1.0.7
                Variant: ClassicTextualEdit
                Properties:
                  DataField: ="Reasonfordeskreservation"
                  Default: =ThisItem.'Reason for desk reservation'
                  DisplayName: =DataSourceInfo([@'Desk Reservations'],DataSourceInfo.DisplayName,'Reason for desk reservation')
                  Height: =127
                  MaxLength: =DataSourceInfo([@'Desk Reservations'], DataSourceInfo.MaxLength, 'Reason for desk reservation')
                  Required: =false
                  Update: =DataCardValue1.Text
                  Width: |-
                    =Parent.Width
                    // 568
                  X: =0
                  Y: =2
                Children:
                  - DataCardKey1:
                      Control: Label@2.5.1
                      MetadataKey: FieldName
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =App.Theme.Colors.Darker30
                        Height: =38
                        Italic: =true
                        LineHeight: =1
                        PaddingRight: =25
                        Size: =12
                        Text: |-
                          ="OPTIONAL:    
                               Free-text any additional comments, concerns, learning accommodations, or any other relavant information about this reservation in the box below:"
                        Width: =DataCardValue1.Width
                        X: =30
                  - DataCardValue1:
                      Control: Classic/TextInput@2.3.2
                      MetadataKey: FieldValue
                      Properties:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        Default: =Parent.Default
                        DelayOutput: =true
                        DisplayMode: =Parent.DisplayMode
                        EnableSpellCheck: =true
                        FontWeight: =FontWeight.Bold
                        Height: =88
                        HintText: =
                        MaxLength: =Parent.MaxLength
                        Mode: =TextMode.MultiLine
                        PaddingLeft: =5
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =14
                        Tooltip: =Parent.DisplayName
                        Width: =Parent.Width - 60
                        X: =35
                        Y: =DataCardKey1.Y + DataCardKey1.Height + 5
                  - ErrorMessage1:
                      Control: Label@2.5.1
                      MetadataKey: ErrorMessage
                      Properties:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =RGBA(168, 0, 0, 1)
                        FontWeight: =FontWeight.Semibold
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =24
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue1.Y + DataCardValue1.Height
                  - StarVisible1:
                      Control: Label@2.5.1
                      MetadataKey: FieldRequired
                      Properties:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =App.Theme.Colors.Darker30
                        Height: =DataCardKey1.Height
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey1.Y
      - Rectangle2_11:
          Control: Rectangle@2.3.0
          Group: grpHeader_11
          Properties:
            Fill: =RGBA(135, 78, 181, 0.65)
            Height: =150
            Width: =Parent.Width
      - Image2_12:
          Control: Image@2.2.3
          Group: grpHeader_11
          Properties:
            Height: =150
            Image: =abstractBackground
            ImagePosition: =ImagePosition.Fill
            Width: =Parent.Width
      - btnContinueDate_1:
          Control: Classic/Button@2.2.0
          Properties:
            DisplayMode: =If(Form1.Valid, DisplayMode.Edit,DisplayMode.Disabled)
            Fill: =RGBA(15, 108, 189, 1)
            Height: =45
            HoverFill: =ColorFade(Self.Fill, -20%)
            OnSelect: |-
              =// 1. Set global variables
              Set(varAttendees, Concat(DataCardValue3.SelectedItems, Email, ";")); // CBPeoplepicker
              //Set(varOptionalAttendees, Concat(OptionAttendeesPP.SelectedItems, Email, ";"));
              Set(varMeetCat, DropdownCanvas1.Selected.Value);
              Set(varReservePOC, DataCardValue7.Selected.Email); // CBMPeoplepicker
              Set(varTitle, "BCVAMC EHRM Training Room & Desk Reservation"); //DataCardValue8.Text); // TBService
              Set(varDescription, DataCardValue1.Text); // RDReason 
              Set(varEmailBody, "***PLEASE DISREGARD THE COORDINATED UNIVERSAL TIME SHOWN ABOVE***<br><br> Please follow this Link to view your Desk Reservations: <br> https://apps.gov.powerapps.us/play/e/default-e95f1b23-abaf-45ee-821d-b7ab251ab3bf/a/81adf8d2-7dfd-4915-9999-f28857d14a9c?tenantId=e95f1b23-abaf-45ee-821d-b7ab251ab3bf&hint=f71f21b7-125c-4ce7-ae22-e8815c50196f&sourcetime=1758755444988&source=portal <br> <br> ***FOLLOW THE LINK ABOVE and then Click on My Bookings or Click the BLUE button to see your Training Calander for your EHRM DESK RESERVATIONS THAT HAVE BEEN BOOKED*** <br>"); //DataCardValue1.Text); // RDReason
              //Set(varURL,"https://apps.gov.powerapps.us/play/e/default-e95f1b23-abaf-45ee-821d-b7ab251ab3bf/a/81adf8d2-7dfd-4915-9999-f28857d14a9c?tenantId=e95f1b23-abaf-45ee-821d-b7ab251ab3bf&hint=f71f21b7-125c-4ce7-ae22-e8815c50196f&sourcetime=1758755444988&source=portal#");
              //Set(varURLName, "BCVAMC EHRM Training Desk Booking");

              Navigate(chkWeekDays)
            Size: |-
              =If(
                  btnContinueDate_1.DisplayMode = DisplayMode.Disabled,
                  16,
                  24
              )
            Text: |-
              =If(
                  btnContinueDate_1.DisplayMode = DisplayMode.Disabled,
                  "Response Missing",
                  "CONTINUE"
              )
            Tooltip: =If(Self.DisplayMode = DisplayMode.Disabled, "You have not completed all required fields.")
            Width: =200
            X: =btnBackDate_1.X + btnBackDate_1.Width + 20
            Y: =btnBackDate_1.Y
      - btnBackDate_1:
          Control: Classic/Button@2.2.0
          Properties:
            Fill: =RGBA(128, 128, 128, 1)
            Height: =45
            HoverFill: =ColorFade(Self.Fill, -20%)
            OnSelect: |-
              =/*
              Reset(tbFloorDesk);
              Reset(tbNameDesk);
              Reset(toggleActive);
              Reset(tbDescrDesk);
              Reset(tbMapDesk);
              Reset(tbDeskLocation_2);
              Reset(tbRoomPhoto);
              Reset(ddAsset) ;Back()
              */
              ResetForm(Form1);
              Back()
            Text: ="Back"
            Width: =200
            X: =(Parent.Width - (Self.Width + 20 + btnContinueDate_1.Width)) / 2
            Y: =70
      - lblSelectDate_1:
          Control: Label@2.5.1
          Properties:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Bold
            Height: =50
            Size: =32
            Text: ="Create a new reservation..."
            Width: =600
            X: =(Parent.Width - Self.Width) / 2
