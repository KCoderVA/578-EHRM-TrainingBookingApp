# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  scrn_WeeklyCal_1:
    Properties:
      OnVisible: |+
        =Set(_dateSelected2, _CurrentDate2);
        Set(_firstDayofWeek2,
        Switch(Weekday(_dateSelected2),
        7, DateAdd(_dateSelected2,-6, TimeUnit.Days),
        6, DateAdd(_dateSelected2,-5, TimeUnit.Days),
        5, DateAdd(_dateSelected2,-4, TimeUnit.Days),
        4, DateAdd(_dateSelected2,-3, TimeUnit.Days),
        3, DateAdd(_dateSelected2,-2, TimeUnit.Days),
        2, DateAdd(_dateSelected2,-1, TimeUnit.Days),
        1, DateAdd(_dateSelected2,-0, TimeUnit.Days),
        DateValue("01/01/2022")));
        // Items property of Dropdown2
        ClearCollect(
            colRoomFilter,
            {Title: "All"}
        );
        Collect(
            colRoomFilter,
            ShowColumns(Filter(Desks, Asset.Value = "Room"),Title)
        );
    Children:
      - Container1_1:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Height: =617
            Width: =1061
            X: =75
          Children:
            - Label11_2:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  FontWeight: =FontWeight.Bold
                  Height: =25
                  Size: =20
                  Text: ="Daily Calendar List"
                  Width: =1045
                  Y: =1
            - Rectangle8_2:
                Control: Rectangle@2.3.0
                Properties:
                  Fill: =RGBA(102, 182, 227, 1)
                  Height: =63
                  Width: =1061
                  Y: =26
            - Label12_2:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  Color: =RGBA(255, 255, 255, 1)
                  FontWeight: =FontWeight.Bold
                  Height: =64
                  Text: ="Daily Training Room List"//Text(_firstDayofWeek2, "mmmm yyyy")
                  Width: =769
                  X: =138
                  Y: =16
            - Icon5_2:
                Control: Classic/Icon@2.5.0
                Properties:
                  Height: =67
                  Icon: =Icon.ChevronRight
                  OnSelect: =Set(_firstDayofWeek2, DateAdd(_firstDayofWeek2, 7, TimeUnit.Days))
                  Visible: =false
                  Width: =61
                  X: =990
                  Y: =23
            - Icon7_2:
                Control: Classic/Icon@2.5.0
                Properties:
                  Icon: =Icon.ChevronLeft
                  OnSelect: =Set(_firstDayofWeek2, DateAdd(_firstDayofWeek2, -7, TimeUnit.Days));
                  Visible: =false
                  X: =7
                  Y: =22
            - Button4_1:
                Control: Classic/Button@2.2.0
                Properties:
                  Height: =33
                  OnSelect: =Navigate(scrn_MoCalendar)
                  Size: =14
                  Text: ="Monthly"
                  Visible: =!hideForPDF
                  Width: =111
                  X: =692
                  Y: =53
            - Icon4_1:
                Control: Classic/Icon@2.5.0
                Properties:
                  Icon: =Icon.Print
                  OnSelect: |-
                    =UpdateContext({hideForPDF: true});
                    Set(
                        PDFPrint,
                        PDF(
                            Container1_1,
                            {
                                PaperSize: PaperSize.A4,
                                PaperOrientation: PaperOrientation.Landscape
                            }
                        )
                    );
                    UpdateContext({hideForPDF: false});
                    Print();
                    Navigate(PDFScreen);
                  Visible: =!hideForPDF
                  X: =926
                  Y: =26
            - Dropdown2_1:
                Control: Classic/DropDown@2.3.1
                Properties:
                  Height: =50
                  Items: |-
                    =colRoomFilter
                    //'Desk Reservations'.TitlecolRoomFilter
                  Items.Value: =Title
                  Visible: =!hideForPDF
                  Width: =229
                  X: =95
                  Y: =30
            - Gallery14:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  Height: =468
                  Items: |-
                    =Filter(
                        'Desk Reservations',
                        DateValue(RecurrenceEndDate) = Today() && 
                        (Dropdown2_1.Selected.Title = "All" || DeskFloor = Dropdown2_1.Selected.Title)
                    )
                  TemplateSize: =35
                  Width: =1061
                  Y: =130
                Children:
                  - NextArrow2:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        AccessibleLabel: =Self.Tooltip
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =RGBA(166, 166, 166, 1)
                        DisabledBorderColor: =RGBA(56, 56, 56, 1)
                        DisabledColor: =RGBA(119, 119, 119, 1)
                        DisplayMode: |+
                          =If(
                              ThisItem.'Created By'.Email = varUser.Email || isUserAdminSPList && ThisItem.'Created By'.DisplayName = "Admin",
                              DisplayMode.Edit,
                              DisplayMode.Disabled
                          )
                          //DisplayMode.Edit
                          //Admin.Email = varUser.Email
                        Height: =50
                        Icon: =Icon.ChevronRight
                        OnSelect: |+
                          =Set(varDaily, ThisItem.ID);
                          Set(varSelectedReservation, ThisItem);
                          Navigate(Reservation, ScreenTransition.Fade)
                        PaddingBottom: =16
                        PaddingLeft: =16
                        PaddingRight: =16
                        PaddingTop: =16
                        Tooltip: ="View item details"
                        Width: =65
                        X: =966
                  - Rectangle14:
                      Control: Rectangle@2.3.0
                      Properties:
                        Fill: =App.Theme.Colors.Darker30
                        Height: =//Parent.TemplateHeight - Separator8.Height
                        OnSelect: =Select(Parent)
                        Visible: =ThisItem.IsSelected
                        Width: =4
                  - Subtitle4_1:
                      Control: Label@2.5.1
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        FontWeight: =FontWeight.Semibold
                        Height: =20
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =12
                        Text: =ThisItem.Description
                        VerticalAlign: =VerticalAlign.Top
                        Width: =151
                        X: =711
                        Y: =15
                  - Title8:
                      Control: Label@2.5.1
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =RGBA(50, 49, 48, 1)
                        FontWeight: =FontWeight.Semibold
                        Height: =20
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =12
                        Text: =ThisItem.Title
                        VerticalAlign: =VerticalAlign.Top
                        Width: =589
                        X: =104
                        Y: =15
                  - Subtitle4:
                      Control: Label@2.5.1
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        FontWeight: =FontWeight.Semibold
                        Height: =20
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =12
                        Text: =ThisItem.ID
                        VerticalAlign: =VerticalAlign.Top
                        Width: =58
                        X: =25
                        Y: =15
            - Button1_1:
                Control: Classic/Button@2.2.0
                Properties:
                  Height: =32
                  OnSelect: =Navigate(scrn_WeeklyCal)
                  Size: =16
                  Text: ="Weekly"
                  Width: =97
                  X: =814
                  Y: =54
            - TextCanvas2:
                Control: Text@0.0.51
                Properties:
                  Height: =46
                  Size: =18
                  Text: ="ID#"
                  Weight: ='TextCanvas.Weight'.Semibold
                  Width: =73
                  X: =22
                  Y: =107
            - TextCanvas5_1:
                Control: Text@0.0.51
                Properties:
                  Height: =46
                  Size: =18
                  Text: =" POC Comments"
                  Weight: ='TextCanvas.Weight'.Semibold
                  Width: =207
                  X: =704
                  Y: =107
            - TextCanvas2_1:
                Control: Text@0.0.51
                Properties:
                  Height: =46
                  Size: =18
                  Text: =" Desk Reservation Info"
                  Weight: ='TextCanvas.Weight'.Semibold
                  Width: =307
                  X: =95
                  Y: =107
      - Rectangle7_2:
          Control: Rectangle@2.3.0
          Properties:
            Height: =595
            Width: =62
            Y: =22
      - Icon3_2:
          Control: Classic/Icon@2.5.0
          Properties:
            Height: =58
            Icon: =Icon.Home
            OnSelect: =Navigate(Dashboard)
            Width: =62
            Y: =22
      - TextCanvas1_2:
          Control: Text@0.0.51
          Properties:
            FontColor: =RGBA(255, 255, 255, 1)
            Height: =38
            Size: =16
            Text: ="Select Calendar View"
            VerticalAlign: =VerticalAlign.Middle
            Weight: ='TextCanvas.Weight'.Semibold
            Width: =154
            X: =838
            Y: =22
      - Rectangle3_15:
          Control: Rectangle@2.3.0
          Group: grpConfirmCancel_3
          Properties:
            Fill: =RGBA(116, 116, 116, 0.85)
            Height: =292
            Visible: =varConfirmCancel
            Width: =804
            Y: =118
      - bgRounded_17:
          Control: HtmlViewer@2.1.0
          Group: grpConfirmCancel_3
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Font: =Font.'Open Sans'
            Height: =490
            HtmlText: ="<div style='border:1px gray;border-radius:10%;height:450px;width:100%;background-color:#FCFCFC'></div>"
            Size: =24
            Visible: =varConfirmCancel
            Width: =720
            X: =236
            Y: =150
      - Container3_1:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =415
            Visible: =varCancelContainer
            Width: =1022
            X: =75
            Y: =186
          Children:
            - bgRounded_18:
                Control: HtmlViewer@2.1.0
                Properties:
                  DisabledBorderColor: =RGBA(56, 56, 56, 1)
                  Font: =Font.'Open Sans'
                  Height: =322
                  HtmlText: ="<div style='border:1px gray;border-radius:10%;height:870px;width:100%;background-color:#FCFCFC'></div>"
                  Size: =24
                  Width: =1010
            - Rectangle3_16:
                Control: Rectangle@2.3.0
                Group: grpMap_9
                Properties:
                  Fill: =RGBA(116, 116, 116, 0.85)
                  Height: =415
                  Visible: =showMap
                  Width: =1022
            - Image5_11:
                Control: Image@2.2.3
                Group: grpMap_9
                Properties:
                  Height: =415
                  Image: =LookUp(Desks,Title = varSelectedReservation.DeskText).RoomPicture
                  ImagePosition: =ImagePosition.Stretch
                  Visible: =showMap
                  Width: =1022
            - lblMapDesk_7:
                Control: Label@2.5.1
                Properties:
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Semibold
                  Text: ="From"
                  Width: =250
                  X: =61
            - tbMapDesk_4:
                Control: Classic/TextInput@2.3.2
                Properties:
                  AccessibleLabel: ="Map Link Input"
                  BorderColor: =RGBA(179, 179, 179, 1)
                  BorderThickness: =1
                  Default: =varSelectedReservation.'Check Out From'
                  DisplayMode: =DisplayMode.View
                  Font: =Font.'Segoe UI'
                  Size: =18
                  Width: =250
                  X: =130
            - lblToRes_2:
                Control: Label@2.5.1
                Properties:
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Semibold
                  Text: ="To"
                  Width: =250
                  X: =400
            - tbTo_2:
                Control: Classic/TextInput@2.3.2
                Properties:
                  AccessibleLabel: ="Map Link Input"
                  BorderColor: =RGBA(179, 179, 179, 1)
                  BorderThickness: =1
                  Default: =varSelectedReservation.'Check Out To'
                  DisplayMode: =DisplayMode.View
                  Font: =Font.'Segoe UI'
                  Size: =18
                  Width: =250
                  X: =452
            - Icon1_11:
                Control: Classic/Icon@2.5.0
                Group: grpMap_9
                Properties:
                  AccessibleLabel: ="Close Map"
                  Color: =RGBA(255, 255, 255, 1)
                  Height: =84
                  Icon: =Icon.Cancel
                  OnSelect: =UpdateContext({showMap:!showMap})
                  TabIndex: =11
                  Visible: =showMap
                  Width: =60
                  X: =962
            - lblReservedOn_2:
                Control: Label@2.5.1
                Properties:
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Semibold
                  Height: =39
                  Text: ="Reserved On"
                  Width: =254
                  Y: =70
            - tbReservedOn_2:
                Control: Classic/TextInput@2.3.2
                Properties:
                  AccessibleLabel: ="Map Link Input"
                  BorderColor: =RGBA(179, 179, 179, 1)
                  BorderThickness: =1
                  Default: =varSelectedReservation.Created
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Font: =Font.'Segoe UI'
                  Height: =38
                  Size: =18
                  Width: =250
                  X: =179
                  Y: =70
            - tbFloorDesk_5:
                Control: Classic/TextInput@2.3.2
                Properties:
                  AccessibleLabel: ="Floor Input"
                  BorderColor: =RGBA(179, 179, 179, 1)
                  BorderThickness: =1
                  Default: =LookUp(Desks,Title = varSelectedReservation.DeskText).'Room Location'
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Font: =Font.'Segoe UI'
                  Height: =73
                  Size: =18
                  Width: =150
                  X: =229
                  Y: =95
            - lblNameDesk_4:
                Control: Label@2.5.1
                Properties:
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Semibold
                  Text: ="Conference Room"
                  Y: =98
            - lblFloorDesk_5:
                Control: Label@2.5.1
                Properties:
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Semibold
                  Text: ="Floor/Room"
                  Width: =290
                  Y: =156
            - tbNameDesk_4:
                Control: Classic/TextInput@2.3.2
                Properties:
                  AccessibleLabel: ="Desk Name Input"
                  BorderColor: =RGBA(179, 179, 179, 1)
                  BorderThickness: =1
                  Default: =varSelectedReservation.DeskText
                  DisplayMode: =DisplayMode.View
                  Font: =Font.'Segoe UI'
                  Size: =18
                  Width: =331
                  X: =181
                  Y: =156
            - lblDescrDesk_4:
                Control: Label@2.5.1
                Properties:
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Semibold
                  Height: =55
                  Text: ="Description"
                  Width: =290
                  Y: =223
            - tbDescrDesk_4:
                Control: Classic/TextInput@2.3.2
                Properties:
                  AccessibleLabel: ="Desk Description Input"
                  BorderColor: =RGBA(179, 179, 179, 1)
                  BorderThickness: =1
                  Default: |-
                    =

                    varSelectedReservation.'Reason for desk reservation'
                    //LookUp(Desks,Title = varSelectedReservation.DeskText).Description
                  DisplayMode: =DisplayMode.View
                  Font: =Font.'Segoe UI'
                  Height: =111
                  Mode: =TextMode.MultiLine
                  Size: =18
                  Width: =493
                  X: =181
                  Y: =234
            - btnBackDeskEdit_4:
                Control: Classic/Button@2.2.0
                Properties:
                  Fill: =RGBA(128, 128, 128, 1)
                  HoverFill: =ColorFade(Self.Fill, -20%)
                  OnSelect: |-
                    =Reset(tbDescrDesk_4);
                    Reset(tbFloorDesk_5);
                    Reset(tbMapDesk_4);
                    Reset(tbNameDesk_4);
                    Set(varCancelContainer, false)
                  Text: ="Back"
                  Width: =200
                  X: =130
                  Y: =345
            - btnUpdate_3:
                Control: Classic/Button@2.2.0
                Properties:
                  Fill: =RGBA(184, 0, 0, 1)
                  HoverFill: =ColorFade(Self.Fill, -20%)
                  OnSelect: =UpdateContext({varConfirmCancel:true});Set(varCancelContainer, false)
                  Text: ="CANCEL"
                  Width: =260
                  X: =512
                  Y: =345
      - Label1_4:
          Control: Label@2.5.1
          Group: grpConfirmCancel_3
          Properties:
            Align: =Align.Center
            FontWeight: =FontWeight.Semibold
            Height: =93
            Size: =24
            Text: ="Confirm Cancellation"
            Visible: =varConfirmCancel
            Width: =688
            X: =242
            Y: =262
      - RadioGroupCanvas1_1:
          Control: Radio@0.0.25
          Properties:
            Height: =80
            Items: =["This Reservation", "Series"]
            Visible: =varConfirmCancel
            X: =436
            Y: =343
      - btnConfirmCancel_4:
          Control: Classic/Button@2.2.0
          Group: grpConfirmCancel_3
          Properties:
            BorderThickness: =0
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(128, 128, 128, 1)
            Height: =72
            HoverFill: =ColorFade(Self.Fill, -20%)
            OnSelect: =UpdateContext({varConfirmCancel:false})
            RadiusBottomLeft: =20
            RadiusBottomRight: =20
            RadiusTopLeft: =20
            RadiusTopRight: =20
            Size: =14
            Text: ="NEVERMIND"
            Visible: =varConfirmCancel
            Width: =234
            X: =305
            Y: =505
      - btnConfirmDelete_4:
          Control: Classic/Button@2.2.0
          Group: grpConfirmCancel_3
          Properties:
            BorderThickness: =0
            Fill: =RGBA(184, 0, 0, 1)
            Height: =72
            HoverFill: =ColorFade(Self.Fill, -20%)
            OnSelect: |+
              =//Remove('Desk Reservations',varSelectedReservation);UpdateContext({varConfirmCancel:false});Back()
              // OnSelect property for the Confirm button
              If(
                  RadioGroupCanvas1_1.Selected.Value = "Series",
                  RemoveIf(
                      'Desk Reservations',
                      RecurrenceID = varSelectedReservation.RecurrenceID
                  ),
                  Remove(
                      'Desk Reservations',
                      varSelectedReservation
                  )
              );
              UpdateContext({varConfirmCancel: false});
            RadiusBottomLeft: =20
            RadiusBottomRight: =20
            RadiusTopLeft: =20
            RadiusTopRight: =20
            Size: =14
            Text: ="CONFIRM"
            Visible: =varConfirmCancel
            Width: =258
            X: =672
            Y: =505
      - Icon8:
          Control: Classic/Icon@2.5.0
          Properties:
            Height: =0
            Icon: =Icon.HorizontalLine
            Width: =995
            X: =82
            Y: =137
      - Rectangle18:
          Control: Rectangle@2.3.0
          Properties:
            Height: =0
            Width: =982
            X: =95
            Y: =137
      - Rectangle19:
          Control: Rectangle@2.3.0
          Properties:
            Height: =0
            Width: =982
            X: =95
            Y: =137
      - Rectangle20:
          Control: Rectangle@2.3.0
          Properties:
            Height: =2
            Width: =982
            X: =95
            Y: =132
