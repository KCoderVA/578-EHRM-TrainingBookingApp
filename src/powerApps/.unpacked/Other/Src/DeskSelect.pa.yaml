# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  DeskSelect:
    Properties:
      Fill: =RGBA(236, 236, 236, 1)
      Height: =Max(App.Height, App.DesignHeight)
      OnVisible: =UpdateContext({showMap:false});
      Width: =Max(App.Width, App.DesignWidth)
    Children:
      - galleryAvailDesk:
          Control: Gallery@2.15.0
          Variant: BrowseLayout_Vertical_OneTextVariant_ver4.0
          Properties:
            AccessibleLabel: ="Available Desks"
            Height: =433
            Items: |-
              =SortByColumns(
                Filter(
                  Desks,
                  Active = 1,
                  Asset.Value in ["Desk","Item","Room",],
                  // Exclude any title in the overlapped-reservation list:
                  Not(Title in colDeskChckRecur.DeskText),
                  // Honor the room selector:
                  If(
                    Dropdown1.Selected.Result = "All Conference Rms",
                    Asset.Value <> "Desk" && Asset.Value <> "Item",
                    'Room Location' = Dropdown1.Selected.Result
                  )
                ),
                "Title",
                SortOrder.Ascending
                )
            Selectable: =false
            TabIndex: =2
            TemplateSize: =107
            Width: =1136
            Y: =207
          Children:
            - Separator4:
                Control: Rectangle@2.3.0
                Properties:
                  Fill: =RGBA(135, 78, 181, 1)
                  Height: =1
                  OnSelect: =Select(Parent)
                  Width: =Parent.TemplateWidth
                  Y: =Parent.TemplateHeight - 1
            - cbDeskSelect:
                Control: Classic/CheckBox@2.1.0
                Properties:
                  CheckboxBorderColor: =RGBA(39, 113, 194, 1)
                  Default: |+
                    =//CheckCheckbox
                    ThisItem.Title in colSelectedDesks.Title Or ThisItem.'Room Location' in colSelectedDesks.Title 
                    //ThisItem.ID = gv_item.ID 
                  DisplayMode: |-
                    =If(ThisItem.Asset.Value = "Desk" And ThisItem.'Room Location' in colSelectedDesks.Title, DisplayMode.Edit)
                    //If(gv_item.ID = ThisItem.ID, DisplayMode.Edit, DisplayMode.Disabled)
                  FocusedBorderThickness: =0
                  Height: =54
                  OnCheck: |-
                    =If(ThisItem.Asset.Value = "Room", 
                        Clear(colSelectedDesks); 
                        RemoveIf(colSelectedDesks, 'Room Location' = ThisItem.'Room Location'); 
                        Collect(colSelectedDesks,ThisItem),
                        //Else
                        Collect(colSelectedDesks,ThisItem);
                    )
                  OnSelect: =Set(gv_item, ThisItem)
                  OnUncheck: |+
                    =Remove(colSelectedDesks, ThisItem) 

                  Text: =""
                  Visible: =If(Title4.Text = Dropdown1.Selected.Result,false,true)
                  Width: =64
                  X: =343
                  Y: =43
            - Checkbox1_2:
                Control: Classic/CheckBox@2.1.0
                Properties:
                  Default: |+
                    =If(!IsBlank(ThisItem.'Projector/TV'),true,false)
                  DisplayMode: =DisplayMode.View
                  FocusedBorderThickness: =0
                  Height: =58
                  OnSelect: =Select(Parent)
                  Text: ="Projector/TV"
                  Visible: =false
                  Width: =243
                  X: =753
                  Y: =37
            - Checkbox1_1:
                Control: Classic/CheckBox@2.1.0
                Properties:
                  Default: |+
                    =If(!IsBlank(ThisItem.VTel),true,false)
                  DisplayMode: =DisplayMode.View
                  FocusedBorderThickness: =0
                  Height: =58
                  OnSelect: =Select(Parent)
                  Text: ="VTel"
                  Visible: =false
                  Width: =155
                  X: =575
                  Y: =38
            - Checkbox1:
                Control: Classic/CheckBox@2.1.0
                Properties:
                  Default: |+
                    =If(!IsBlank(ThisItem.'Smart Board'),true,false)
                  DisplayMode: =DisplayMode.View
                  FocusedBorderThickness: =0
                  Height: =58
                  OnSelect: =Select(Parent)
                  Text: ="Smart Board"
                  Visible: =false
                  X: =332
                  Y: =38
            - TextCanvas4:
                Control: Text@0.0.51
                Properties:
                  Height: =35
                  Size: =18
                  Text: |-
                    ="Capacity: " & ThisItem.Capacity
                  Weight: ='TextCanvas.Weight'.Bold
                  Width: =128
                  X: =204
                  Y: =54
            - NextArrow4:
                Control: Classic/Icon@2.5.0
                Properties:
                  AccessibleLabel: =Self.Tooltip
                  Height: =49
                  Icon: =Icon.Location
                  OnSelect: =Select(Parent);UpdateContext({showMap:!showMap})
                  PaddingBottom: =10
                  PaddingLeft: =10
                  PaddingRight: =10
                  PaddingTop: =10
                  TabIndex: =0
                  Tooltip: ="View item details"
                  X: =111
                  Y: =46
            - Label7:
                Control: Label@2.5.1
                Properties:
                  Height: =20
                  OnSelect: =Select(Parent)
                  Size: =12
                  Text: ="Map"
                  Width: =51
                  X: =124
                  Y: =37
            - NextArrow4_2:
                Control: Classic/Icon@2.5.0
                Properties:
                  AccessibleLabel: =Self.Tooltip
                  Height: =48
                  Icon: =Icon.PhotosPictures
                  OnSelect: =Select(Parent);UpdateContext({showPhoto:!showPhoto})
                  PaddingBottom: =10
                  PaddingLeft: =10
                  PaddingRight: =10
                  PaddingTop: =10
                  TabIndex: =0
                  Tooltip: ="View item details"
                  Width: =77
                  Y: =48
            - Label7_1:
                Control: Label@2.5.1
                Properties:
                  Height: =20
                  OnSelect: =Select(Parent)
                  Size: =12
                  Text: ="Rm Photo"
                  Width: =94
                  Y: =37
            - Title4:
                Control: Label@2.5.1
                Properties:
                  BorderColor: =RGBA(0, 0, 0, 1)
                  FontWeight: =FontWeight.Semibold
                  Height: =38
                  OnSelect: =Select(Parent)
                  PaddingBottom: =0
                  PaddingLeft: =0
                  PaddingRight: =0
                  PaddingTop: =0
                  Size: =20
                  Text: =ThisItem.Title
                  VerticalAlign: =VerticalAlign.Top
                  Width: =525
      - Dropdown1:
          Control: Classic/DropDown@2.3.1
          Properties:
            Default: ="EHRM Training Rooms"
            Height: =40
            Items: |+
              =//colRoomLocations//ForAll(Distinct(Desks,Title), {Result: ThisRecord.Value})
              SortByColumns(ForAll(Distinct(Desks,'Room Location'), {Result: ThisRecord.Value}), "Result") 
            Items.Value: =Result
            OnChange: =colRoomLocations
            Reset: =true
            Width: =339
            X: =192
            Y: =153
      - Label9:
          Control: Label@2.5.1
          Properties:
            Height: =40
            Text: ="Select Room"
            Width: =174
            Y: =150
      - Label5:
          Control: Label@2.5.1
          Group: grpNoResults
          Properties:
            Align: =Align.Center
            Height: =46
            Text: ="Uh oh, no openings found!"
            Visible: =If(CountRows(galleryAvailDesk.AllItems) >= 1, false, true)
            Width: =1078
            X: =40
            Y: =476
      - Label5_1:
          Control: Label@2.5.1
          Group: grpNoResults
          Properties:
            Align: =Align.Center
            Height: =46
            Text: ="Try selecting another date"
            Visible: =If(CountRows(galleryAvailDesk.AllItems) >= 1, false, true)
            Width: =1078
            X: =40
            Y: =515
      - Rectangle3:
          Control: Rectangle@2.3.0
          Group: grpMap
          Properties:
            AccessibleLabel: ="Close Map"
            Fill: =RGBA(116, 116, 116, 0.85)
            Height: =560
            Visible: =showMap
            Width: =640
            Y: =77
      - Image5:
          Control: Image@2.2.3
          Group: grpMap
          Properties:
            AccessibleLabel: ="Close Map"
            Height: =560
            Image: =galleryAvailDesk.Selected.'Map Link'
            ImagePosition: =ImagePosition.Stretch
            Visible: =showMap
            Width: =1054
            X: =40
            Y: =77
      - Icon1:
          Control: Classic/Icon@2.5.0
          Group: grpMap
          Properties:
            AccessibleLabel: ="Close Map"
            Color: =RGBA(0, 0, 0, 1)
            Height: =40
            Icon: =Icon.Cancel
            OnSelect: =UpdateContext({showMap:!showMap})
            TabIndex: =5
            Visible: =showMap
            X: =1030
            Y: =80
      - Rectangle3_11:
          Control: Rectangle@2.3.0
          Group: grpMap_6
          Properties:
            AccessibleLabel: ="Close Map"
            Fill: =RGBA(116, 116, 116, 0.85)
            Height: =560
            Visible: =showLocation
            Width: =640
            X: =20
            Y: =80
      - Image5_8:
          Control: Image@2.2.3
          Group: grpMap_6
          Properties:
            AccessibleLabel: ="Close Map"
            Height: =560
            Image: =galleryAvailDesk.Selected.'Desk Location'
            ImagePosition: =ImagePosition.Stretch
            Visible: =showLocation
            Width: =1054
            X: =60
            Y: =80
      - Rectangle3_12:
          Control: Rectangle@2.3.0
          Group: grpMap_7
          Properties:
            AccessibleLabel: ="Close Map"
            Fill: =RGBA(116, 116, 116, 0.85)
            Height: =560
            Visible: =showPhoto
            Width: =640
            X: =42
            Y: =80
      - Icon1_9:
          Control: Classic/Icon@2.5.0
          Group: grpMap_7
          Properties:
            AccessibleLabel: ="Close Map"
            Color: =RGBA(0, 0, 0, 1)
            Height: =40
            Icon: =Icon.Cancel
            OnSelect: =UpdateContext({showPhoto:!showPhoto})
            TabIndex: =5
            Visible: =showPhoto
            X: =1072
            Y: =80
      - Image5_9:
          Control: Image@2.2.3
          Group: grpMap_7
          Properties:
            AccessibleLabel: ="Close Map"
            Height: =560
            Image: =galleryAvailDesk.Selected.RoomPicture
            ImagePosition: =ImagePosition.Stretch
            Visible: =showPhoto
            Width: =949
            X: =81
            Y: =77
      - Icon1_8:
          Control: Classic/Icon@2.5.0
          Group: grpMap_6
          Properties:
            AccessibleLabel: ="Close Map"
            Color: =RGBA(0, 0, 0, 1)
            Height: =40
            Icon: =Icon.Cancel
            OnSelect: =UpdateContext({showLocation:!showLocation})
            TabIndex: =5
            Visible: =showLocation
            X: =1050
            Y: =80
      - lblDateDesk:
          Control: Label@2.5.1
          Properties:
            Align: =Align.Center
            Height: =33
            Text: =//startTime & " - " & endTime  //DateTimeValue(Text(selectedDate,DateTimeFormat.ShortDate)&" "&ddTimeFrom.Selected.Value)&" - "&DateTimeValue(Text(selectedEndDate,DateTimeFormat.ShortDate)&" "&ddTimeTo.Selected.Value)
            Visible: =false
            Width: =1136
            Y: =117
      - Image2_2:
          Control: Image@2.2.3
          Properties:
            Height: =150
            Image: =abstractBackground
            ImagePosition: =ImagePosition.Fill
            Width: =Parent.Width
      - btnContinueDesk_1:
          Control: Classic/Button@2.2.0
          Properties:
            Fill: =RGBA(15, 108, 189, 1)
            Height: =45
            HoverFill: =ColorFade(Self.Fill, -20%)
            OnSelect: |-
              =// 1) Pull in only the rows where your checkbox is ticked
              ClearCollect(
                colSelectedDesks,
                Filter(
                  galleryAvailDesk.AllItems,
                  cbDeskSelect.Value    // â† your actual checkbox control name
                )
              );

              // 2) If they picked none, warn; otherwise go on
              If(
                IsEmpty(colSelectedDesks),
                Notify(
                  "Please select at least one desk to continue",
                  NotificationType.Warning,
                  3000
                )
              );

                Navigate( Confirm, ScreenTransition.Fade )
            Text: ="ContinueREC"
            Visible: =false
            Width: =198
            X: =920
            Y: =70
      - btnContinueDesk:
          Control: Classic/Button@2.2.0
          Properties:
            DisplayMode: =If(CountRows(colSelectedDesks) > 0, DisplayMode.Edit, DisplayMode.Disabled)
            Fill: =RGBA(15, 108, 189, 1)
            Height: =45
            HoverFill: =ColorFade(Self.Fill, -20%)
            OnSelect: |-
              =If(IsEmpty(colSelectedDesks), 
                  Notify("Please select a desk to continue",NotificationType.Warning),
                  //Else
                  Set(varAccept3, true);
                  Set(varAccept4, false);
                  Navigate(Confirm)
              )
            Text: ="Continue"
            Width: =200
            X: =btnBackDesk.X + btnBackDesk.Width + 20
            Y: =btnBackDesk.Y
      - btnBackDesk:
          Control: Classic/Button@2.2.0
          Properties:
            Fill: =RGBA(128, 128, 128, 1)
            Height: =45
            HoverFill: =ColorFade(Self.Fill, -20%)
            OnSelect: =Back()
            Text: ="Back"
            Width: =200
            X: =(Parent.Width - (Self.Width + 20 + btnContinueDesk.Width)) / 2
            Y: =70
      - lblSelectDesk:
          Control: Label@2.5.1
          Properties:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Bold
            Height: =50
            Size: =32
            Text: ="Select a Room"
            Width: =400
            X: =(Parent.Width - Self.Width) / 2
      - lblSelectDesk_1:
          Control: Label@2.5.1
          Properties:
            Align: =Align.Center
            Color: =RGBA(106, 122, 127, 1)
            FontWeight: =FontWeight.Bold
            Height: =41
            Size: =22
            Text: ="Desks unavailable will not show up"
            Width: =500
            X: =636
            Y: =112
      - Radio3:
          Control: Classic/Radio@2.3.0
          Properties:
            Items: |-
              =SortByColumns(
                Filter(
                  Desks,
                  Active = 1,
                  Asset.Value in ["Desks","Item", "Room"],
                  // Exclude any title in the overlapped-reservation list:
                  Not(Title in colDeskChckRecur.DeskText),
                  // Honor the room selector:
                  If(
                    Dropdown1.Selected.Result = "All EHRM Training Rooms",
                    Asset.Value <> "Desk" && Asset.Value <> "Item",
                    'Room Location' = Dropdown1.Selected.Result
                  )
                ),
                "Title",
                SortOrder.Ascending
              )
            Items.Value: =ComplianceAssetId
            X: =778
            Y: =169
