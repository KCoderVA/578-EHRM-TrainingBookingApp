# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  Dashboard:
    Properties:
      Fill: =RGBA(236, 236, 236, 1)
      Height: =Max(App.Height, App.DesignHeight)
      OnVisible: |+
        =ClearCollect(
            colMenu,
            Table(
                {
                    Name: "Dashboard",
                    Icon: Icon.DetailList,
                    Page: Dashboard,
                    Visible: true
                },
                {
                    Name: "My Bookings",
                    Icon: Icon.Person,
                    Page: MyAppts,
                    Visible: true
                },
                       {
                    Name: "Book",
                    Icon: Icon.Add,
                    Page: POCSUPERVISOR,
                    Visible: true
                }         
            )
        );
        Set(
            _CurrentUser,
            User()
        );
        Set(
            _CurrentDate2,
            Today()
        );
        Set(
            _CurrentUser,
            User()
        );
        Set(
            _CurrentDate2,
            Today()
        );
        Set(
            varTimer,
            true
        );
        Set(
            currentUser,
            User()
        );
        Set(
            varTimer,
            false
        );
        Set(
            varUser,
            User()
        );
        Set(
            isUserAdminSPList,
            !IsBlank(
                LookUp(
                    DeskAccessControl,
                    Lower(Email_Text) = Lower(varUser.Email)
                )
            )
        );
        If(isUserAdminSPList, 
            Collect(colMenu, 
                {
                    Name: "Manage Rooms",
                    Icon: Icon.ComputerDesktop,
                    Page: ManageDesks,
                    Visible: true
                }
            )
        );
        ClearCollect(CollectionRecurrence, Blank());
      Width: =Max(App.Width, App.DesignWidth)
    Children:
      - Button5:
          Control: Classic/Button@2.2.0
          Properties:
            Height: =94
            OnSelect: =Navigate(scrn_WeeklyCal)
            Text: ="Click to see calendar"
            Width: =240
            X: =78
            Y: =527
      - Image2_13:
          Control: Image@2.2.3
          Properties:
            Height: =211
            Image: =abstractBackground
            ImagePosition: =ImagePosition.Fill
            Width: =Parent.Width
      - bgRounded_3:
          Control: HtmlViewer@2.1.0
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Font: =Font.'Open Sans'
            Height: =623
            HtmlText: ="<div style='border:1px gray;border-radius:10%;height:600px;width:100%;background-color:#FCFCFC'></div>"
            Size: =24
            Width: =528
            X: =608
            Y: =17
      - gallMyReservationsPreview:
          Control: Gallery@2.15.0
          Variant: BrowseLayout_Vertical_OneTextVariant_ver4.0
          Properties:
            AccessibleLabel: ="Upcoming Reservations"
            Height: =494
            Items: |-
              =// Show first N events
              FirstN(
                  SortByColumns(
                      Filter(
                          'Desk Reservations',
                          ('Reserved By'.Email = currentUser.Email || 'Created By'.Email = currentUser.Email) &&
                          'Check Out From' >= Today()
                      ),
                      "CheckOutFrom",
                      SortOrder.Ascending
                  ),
                  500
              )
            TabIndex: =5
            TemplateSize: =107
            Width: =504
            X: =620
            Y: =97
          Children:
            - Separator2:
                Control: Rectangle@2.3.0
                Properties:
                  Fill: =RGBA(15, 108, 189, 1)
                  Height: =1
                  OnSelect: =Select(Parent)
                  Width: =Parent.TemplateWidth
                  Y: =Parent.TemplateHeight - 1
            - Label6:
                Control: Label@2.5.1
                Properties:
                  FontWeight: =FontWeight.Bold
                  Height: =26
                  OnSelect: =Select(Parent)
                  Size: =16
                  Text: =ThisItem.'Reason for desk reservation'
                  Width: =515
                  Y: =80
            - Title2_14:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 0, 0, 1)
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Semibold
                  Height: =57
                  OnSelect: =Select(Parent)
                  PaddingBottom: =0
                  PaddingLeft: =0
                  PaddingRight: =0
                  PaddingTop: =0
                  Size: =18
                  Text: =Upper(Text(DateTimeValue(ThisItem.'Check Out To Text'),"[$-en-US]mmm"))
                  VerticalAlign: =VerticalAlign.Top
                  Visible: =If(Upper(Text(DateTimeValue(ThisItem.'Check Out From'),"[$-en-US]dd")) = Upper(Text(DateTimeValue(ThisItem.'Check Out To'),"[$-en-US]dd")), false, true)
                  Width: =94
                  Y: =50
            - Title2_15:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 0, 0, 1)
                  Color: =RGBA(135, 78, 181, 1)
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Bold
                  Height: =45
                  OnSelect: =Select(Parent)
                  PaddingBottom: =0
                  PaddingLeft: =0
                  PaddingRight: =0
                  PaddingTop: =0
                  Size: =18
                  Text: =Upper(Text(DateTimeValue(ThisItem.'Check Out To Text'),"[$-en-US]dd"))
                  VerticalAlign: =VerticalAlign.Top
                  Visible: =Title2_14.Visible
                  Width: =72
                  X: =69
                  Y: =50
            - Label2_1:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  FontWeight: =FontWeight.Semibold
                  Height: =29
                  OnSelect: =Select(Parent)
                  Text: =" to "
                  Visible: =Title2_14.Visible
                  Width: =50
                  X: =52
                  Y: =21
            - Icon6:
                Control: Classic/Icon@2.5.0
                Properties:
                  Color: =RGBA(15, 108, 189, 1)
                  Height: =45
                  Icon: =Icon.OpenInNewWindow
                  OnSelect: =Set(varSelectedReservation,ThisItem);Navigate(Reservation)
                  Visible: =false
                  Width: =45
                  X: =430
            - Title2_3:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 0, 0, 1)
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Semibold
                  Height: =24
                  OnSelect: =Select(Parent)
                  PaddingBottom: =0
                  PaddingLeft: =10
                  PaddingRight: =10
                  PaddingTop: =0
                  Size: =16
                  Text: =Text(DateTimeValue(ThisItem.'Check Out From'), DateTimeFormat.ShortTime) & " to " & Text(DateTimeValue(ThisItem.'Check Out To'), DateTimeFormat.ShortTime)
                  VerticalAlign: =VerticalAlign.Top
                  Width: =300
                  X: =130
                  Y: =60
            - Title2_2:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 0, 0, 1)
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Semibold
                  Height: =24
                  OnSelect: =Select(Parent)
                  PaddingBottom: =0
                  PaddingLeft: =10
                  PaddingRight: =10
                  PaddingTop: =0
                  Size: =16
                  Text: =ThisItem.DeskText
                  VerticalAlign: =VerticalAlign.Top
                  Width: =300
                  X: =130
                  Y: =26
            - Title2_1:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 0, 0, 1)
                  Color: =RGBA(15, 108, 189, 1)
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Bold
                  Height: =45
                  OnSelect: =Select(Parent)
                  PaddingBottom: =0
                  PaddingLeft: =0
                  PaddingRight: =0
                  PaddingTop: =0
                  Size: =18
                  Text: |-
                    =Upper(
                        Text(
                            DateTimeValue(ThisItem.'Check Out From'),
                            "[$-en-US]dd"
                        )
                    )
                  VerticalAlign: =VerticalAlign.Top
                  Width: =76
                  X: =68
            - Title2:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 0, 0, 1)
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Semibold
                  Height: =57
                  OnSelect: =Select(Parent)
                  PaddingBottom: =0
                  PaddingLeft: =0
                  PaddingRight: =0
                  PaddingTop: =0
                  Size: =18
                  Text: =Upper(Text(DateTimeValue(ThisItem.'Check Out From'),"[$-en-US]mmm"))
                  VerticalAlign: =VerticalAlign.Top
                  Width: =94
            - Title2_20:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 0, 0, 1)
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Semibold
                  Height: =57
                  OnSelect: =Select(Parent)
                  PaddingBottom: =0
                  PaddingLeft: =10
                  PaddingRight: =10
                  PaddingTop: =0
                  Size: =16
                  Text: =ThisItem.DeskFloor
                  VerticalAlign: =VerticalAlign.Top
                  Width: =300
                  X: =130
      - lblMyUpcomingRes:
          Control: Label@2.5.1
          Properties:
            Align: =Align.Center
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =57
            Text: ="Upcoming Reservations (" & gallMyReservationsPreview.AllItemsCount & ")"
            Width: =448
            X: =648
            Y: =40
      - lblNoResDashboard:
          Control: Label@2.5.1
          Properties:
            Align: =Align.Center
            FontWeight: =FontWeight.Lighter
            Height: =88
            Text: ="No upcoming reservations"
            Visible: =If(CountRows(gallMyReservationsPreview.AllItems) >=1, false, true)
            Width: =515
            X: =621
            Y: =353
      - Preloader_1:
          Control: CanvasComponent
          ComponentName: Preloader
          Properties:
            AnimatedGIF: ="https://aka.ms/preloadergif"
            Color: =
            Fill: =RGBA(255, 255, 255, 1)
            IsLoading: =true
            Styles: =Table({Key:"Fill", Value:"#0086D0" , Type:"Color"})
            Text: ="LOADING..."
            Visible: =varTimer
      - Label4:
          Control: Label@2.5.1
          Properties:
            Align: =Align.Center
            Height: =54
            Text: ="View all current reservations"
            Width: =396
            Y: =473
      - HtmlText2:
          Control: HtmlViewer@2.1.0
          Properties:
            Font: =Font.'Open Sans'
            Height: =248
            HtmlText: |+
              ="<div style='font-size:16px; font-weight:bold;'>Welcome to the Battle Creek VA Room Reservation Portal!</div><br>" & 
              "<div style='font-size:14px;'>Rooms listed may be reserved for Super User or End User Virtual Instructor Led Training (VILT) events (Seating Range: 8-16+). Each EHRM Training workstation contains a monitor, keyboard, mouse, barcode scanner, and laptop. There are tables and chairs located in each room.  <br><br>***Please bring Headphones with Microphone as other trainees are in different classes***<br><br>"&  
              "Weâ€™d recommend contacting the following individuals for room reservations or questions:<br>" & 
              "<a href='mailto:Denise.patterer@va.gov?subject=Conference%20Room%20Reservation'>Denise Patterer</a> or <a href='mailto:Sean.Krontz@va.gov?subject=Conference%20Room%20Reservation'>Sean Krontz</a>.<br><br>" & 
              "Please feel free to reach out to <a href='mailto:vhabacclt@va.gov?subject=Conference%20Room%20Reservation'>Battle Creek CLT</a> Change Leadership Team (CLT) or the Points of Contact listed above if you have any questions or concerns.</div>"
            Size: =
            Width: =608
            Y: =211
      - Tabs_1:
          Control: CanvasComponent
          ComponentName: Tabs
          Properties:
            Height: =114
            HomePage: =App.ActiveScreen
            Items: =colMenu
            Width: =608
            Y: =97
      - lblWelcome:
          Control: Label@2.5.1
          Properties:
            Color: =RGBA(255, 255, 255, 1)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Height: =80
            Size: =32
            Text: |-
              ="Welcome back, " & Trim(Last(FirstN(ForAll(Split(currentUser.FullName," "), {Result: ThisRecord.Value}), 1)).Result)
            Width: =606
            X: =15
            Y: =17
      - Label8:
          Control: Label@2.5.1
          Properties:
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Semibold
            Height: =45
            Size: =14
            Text: ="V1"
            Width: =53
            X: =15
