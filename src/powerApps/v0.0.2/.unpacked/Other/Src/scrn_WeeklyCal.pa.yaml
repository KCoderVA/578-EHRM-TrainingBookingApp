# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  scrn_WeeklyCal:
    Properties:
      OnVisible: |
        =Set(
            _dateSelected2,
            _CurrentDate2
        );
        Set(
            _firstDayofWeek2,
            Switch(
                Weekday(_dateSelected2),
                7,
                DateAdd(
                    _dateSelected2,
                    -6,
                    TimeUnit.Days
                ),
                6,
                DateAdd(
                    _dateSelected2,
                    -5,
                    TimeUnit.Days
                ),
                5,
                DateAdd(
                    _dateSelected2,
                    -4,
                    TimeUnit.Days
                ),
                4,
                DateAdd(
                    _dateSelected2,
                    -3,
                    TimeUnit.Days
                ),
                3,
                DateAdd(
                    _dateSelected2,
                    -2,
                    TimeUnit.Days
                ),
                2,
                DateAdd(
                    _dateSelected2,
                    -1,
                    TimeUnit.Days
                ),
                1,
                DateAdd(
                    _dateSelected2,
                    -0,
                    TimeUnit.Days
                ),
                Today() // DateValue("01/01/2026")
            )
        );
        // Items property of Dropdown2
        ClearCollect(
            colRoomFilter,
            {Title: "All"}
        );
        Collect(
            colRoomFilter,
            ShowColumns(
                Filter(
                    Desks,
                    Asset.Value = "Room"
                ),
                Title
            )
        );
    Children:
      - Container1:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Height: =617
            Width: =1061
            X: =75
          Children:
            - Gallery2_1:
                Control: Gallery@2.15.0
                Variant: Horizontal
                Properties:
                  BorderThickness: =1
                  DelayItemLoading: =false
                  Height: =528
                  Items: =Calendar.WeekdaysShort()
                  LoadingSpinner: =LoadingSpinner.None
                  TemplatePadding: =0
                  TemplateSize: =150
                  Width: =1069
                  WrapCount: =0
                  Y: =89
                Children:
                  - Label13_1:
                      Control: Label@2.5.1
                      Properties:
                        Align: =Align.Center
                        BorderThickness: =1
                        Fill: =If(ThisItem.Value="Sun" || ThisItem.Value="Sat", RGBA(204, 204, 204, 1), RGBA(0,0,0,0))
                        FocusedBorderThickness: =1
                        FontWeight: =FontWeight.Bold
                        Height: =46
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =14
                        Text: =ThisItem.Value
                        Width: =149
            - Label11_1:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  FontWeight: =FontWeight.Bold
                  Height: =25
                  Size: =20
                  Text: ="Weekly Calendar"
                  Width: =1045
                  Y: =1
            - Rectangle8_1:
                Control: Rectangle@2.3.0
                Properties:
                  Fill: =RGBA(102, 182, 227, 1)
                  Height: =63
                  Width: =1069
                  Y: =26
            - Label12_1:
                Control: Label@2.5.1
                Properties:
                  Align: =Align.Center
                  Color: =RGBA(255, 255, 255, 1)
                  FontWeight: =FontWeight.Bold
                  Height: =64
                  Text: =Text(_firstDayofWeek2, "mmmm yyyy")
                  Width: =769
                  X: =138
                  Y: =16
            - Gallery9:
                Control: Gallery@2.15.0
                Variant: Vertical
                Properties:
                  BorderColor: =RGBA(56, 96, 178, 1)
                  DelayItemLoading: =false
                  Height: =482
                  Items: =[0,1,2,3,4,5,6,]
                  LoadingSpinner: =LoadingSpinner.None
                  ShowScrollbar: =false
                  TemplatePadding: =0
                  TemplateSize: =499
                  Width: =1051
                  WrapCount: =7
                  Y: =135
                Children:
                  - Rectangle9:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderThickness: =1
                        Fill: |-
                          =If(Weekday(DateAdd(_firstDayofWeek2, ThisItem.Value, TimeUnit.Days))=1 ||Weekday(DateAdd(_firstDayofWeek2, ThisItem.Value, TimeUnit.Days))=7,
                          RGBA(204, 204, 204, 1),If(Month(_firstDayofWeek2) =Month(DateAdd(_firstDayofWeek2, ThisItem.Value, TimeUnit.Days)), RGBA(0,0,0,0), RGBA(237,237,237,1)))
                        Height: =499
                        OnSelect: =Select(Parent)
                        Width: =150.14285714285714
                  - Label13_2:
                      Control: Label@2.5.1
                      Properties:
                        Align: =Align.Center
                        BorderThickness: =1
                        Color: =RGBA(0, 94, 146, 1)
                        FocusedBorderThickness: =1
                        FontWeight: =FontWeight.Bold
                        Height: =43
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =12
                        Text: =Text(DateAdd(_firstDayofWeek2, ThisItem.Value, TimeUnit.Days),DateTimeFormat.ShortDate)
                        Width: =149
                  - Gallery10:
                      Control: Gallery@2.15.0
                      Variant: Vertical
                      Properties:
                        DelayItemLoading: =false
                        Height: =456
                        Items: "=/*Filter('Desk Reservations',(DateValue(Text('Check Out From'))<= DateAdd(_firstDayofWeek2, ThisItem.Value, TimeUnit.Days)) &&\r\n(DateValue(Text('Check Out To'))>= DateAdd(_firstDayofWeek2, ThisItem.Value, TimeUnit.Days)))*/\r\n// Items property of your Gallery\r\n// Items property of your Gallery\r\n// Items property of your Gallery\r\n// Items property of your Gallery\r\nFilter(\r\n    'Desk Reservations',\r\n    (DateValue(Text('Check Out From')) <= DateAdd(_firstDayofWeek2, ThisItem.Value, TimeUnit.Days)) &&\r\n    (DateValue(Text('Check Out To')) >= DateAdd(_firstDayofWeek2, ThisItem.Value, TimeUnit.Days)) &&\r\n    (\r\n        Dropdown2.Selected.Title = \"All\" ||\r\n        DeskFloor = Dropdown2.Selected.Title \r\n        \r\n    )\r\n)\r\n"
                        LoadingSpinner: =LoadingSpinner.None
                        TemplatePadding: =0
                        TemplateSize: =66
                        Visible: |-
                          =true
                          //If(Weekday(DateAdd(_firstDayofWeek2, ThisItem.Value,TimeUnit.Days))=0 ||Weekday(DateAdd(_firstDayofWeek2, ThisItem.Value,TimeUnit.Days))=7,false,true)
                        Width: =150.14285714285714
                        Y: =43
                      Children:
                        - Label21:
                            Control: Label@2.5.1
                            Properties:
                              Height: =43
                              OnSelect: =Set(varSelectedReservation,ThisItem);Navigate(Reservation)
                              Size: =9
                              Text: |-
                                =Concatenate(ThisItem.'Reason for desk reservation'," ",Text(ThisItem.'Check Out From', "hh:mm AM/PM") & "  to " & Text(ThisItem.'Check Out To', "hh:mm AM/PM"))

                                //&& Text(DateTimeValue(ThisItem.'Check Out From Text'), DateTimeFormat.ShortTime) & " to " & Text(DateTimeValue(ThisItem.'Check Out To Text'), DateTimeFormat.ShortTime)
                              Visible: =false
                              Width: =150
                        - DeskTextlbl:
                            Control: Text@0.0.51
                            Properties:
                              Height: =43
                              Size: =12
                              Text: |-
                                =Concatenate(ThisItem.Title," " & "to " & Text(ThisItem.'Check Out To', "hh:mm AM/PM"))
                                //ThisItem.Title
                              Weight: ='TextCanvas.Weight'.Bold
                              Width: =150
                        - Button2:
                            Control: Classic/Button@2.2.0
                            Properties:
                              DisplayMode: |-
                                =/*If(
                                    ThisItem.'Created By'.Email = varUser.Email || isUserAdminSPList,*/
                                    DisplayMode.Edit
                                    //DisplayMode.Disabled
                                //)
                                //DisplayMode.Edit
                              Fill: =RGBA(0, 0, 0, 0)
                              Height: =43
                              HoverColor: =RGBA(0, 0, 0, 0)
                              HoverFill: =ColorFade(RGBA(0, 0, 0, 0), -05%)
                              OnSelect: =Set(varSelectedReservation,ThisItem);Set(varCancelContainer, true)
                              Size: =10
                              Text: =""
                              Width: =150
            - Icon5_1:
                Control: Classic/Icon@2.5.0
                Properties:
                  Height: =67
                  Icon: =Icon.ChevronRight
                  OnSelect: =Set(_firstDayofWeek2, DateAdd(_firstDayofWeek2, 7, TimeUnit.Days))
                  Visible: =!hideForPDF
                  Width: =61
                  X: =990
                  Y: =23
            - Icon7_1:
                Control: Classic/Icon@2.5.0
                Properties:
                  Icon: =Icon.ChevronLeft
                  OnSelect: =Set(_firstDayofWeek2, DateAdd(_firstDayofWeek2, -7, TimeUnit.Days));
                  Visible: =!hideForPDF
                  X: =7
                  Y: =22
            - Button4:
                Control: Classic/Button@2.2.0
                Properties:
                  Height: =33
                  OnSelect: =Navigate(scrn_MoCalendar)
                  Size: =14
                  Text: ="Monthly"
                  Visible: =!hideForPDF
                  Width: =111
                  X: =654
                  Y: =53
            - Icon4:
                Control: Classic/Icon@2.5.0
                Properties:
                  Icon: =Icon.Print
                  OnSelect: |-
                    =UpdateContext({hideForPDF: true});
                    Set(
                        PDFPrint,
                        PDF(
                            Container1,
                            {
                                PaperSize: PaperSize.A4,
                                PaperOrientation: PaperOrientation.Landscape
                            }
                        )
                    );
                    UpdateContext({hideForPDF: false});
                    Print();
                    Navigate(PDFScreen);
                  Visible: =!hideForPDF
                  X: =926
                  Y: =26
            - Dropdown2:
                Control: Classic/DropDown@2.3.1
                Properties:
                  Height: =50
                  Items: |-
                    =colRoomFilter
                    //'Desk Reservations'.TitlecolRoomFilter
                  Items.Value: =Title
                  Visible: =!hideForPDF
                  Width: =229
                  X: =95
                  Y: =30
            - Button4_2:
                Control: Classic/Button@2.2.0
                Properties:
                  Height: =33
                  OnSelect: =Navigate(scrn_WeeklyCal_1)
                  Size: =14
                  Text: ="Daily"
                  Visible: =!hideForPDF
                  Width: =111
                  X: =777
                  Y: =53
      - Rectangle7_1:
          Control: Rectangle@2.3.0
          Properties:
            Height: =595
            Width: =62
            Y: =22
      - Icon3_1:
          Control: Classic/Icon@2.5.0
          Properties:
            Height: =58
            Icon: =Icon.Home
            OnSelect: =Navigate(Dashboard)
            Width: =62
            Y: =22
      - Container3:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =415
            Visible: =varCancelContainer
            Width: =1022
            X: =75
            Y: =186
          Children:
            - bgRounded_15:
                Control: HtmlViewer@2.1.0
                Properties:
                  DisabledBorderColor: =RGBA(56, 56, 56, 1)
                  DisplayMode: |-
                    =If(
                        User().Email,
                        DisplayMode.View & If(User().Email, "Admin", DisplayMode.Edit
                    ))
                    //DisplayMode.Edit
                  Font: =Font.'Open Sans'
                  Height: =322
                  HtmlText: ="<div style='border:1px gray;border-radius:10%;height:870px;width:100%;background-color:#FCFCFC'></div>"
                  Size: =24
                  Width: =1010
            - lblNameDesk_3:
                Control: Label@2.5.1
                Properties:
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Semibold
                  Text: ="Conference Room"
                  Y: =98
            - tbNameDesk_3:
                Control: Classic/TextInput@2.3.2
                Properties:
                  AccessibleLabel: ="Desk Name Input"
                  BorderColor: =RGBA(179, 179, 179, 1)
                  BorderThickness: =1
                  Default: =varSelectedReservation.DeskText
                  Font: =Font.'Segoe UI'
                  Size: =18
                  Width: =331
                  X: =181
                  Y: =156
            - lblFloorDesk_4:
                Control: Label@2.5.1
                Properties:
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Semibold
                  Text: ="Floor/Room"
                  Width: =290
                  Y: =156
            - tbFloorDesk_4:
                Control: Classic/TextInput@2.3.2
                Properties:
                  AccessibleLabel: ="Floor Input"
                  BorderColor: =RGBA(179, 179, 179, 1)
                  BorderThickness: =1
                  Default: =LookUp(Desks,Title = varSelectedReservation.DeskText).'Room Location'
                  Fill: =RGBA(0, 0, 0, 0)
                  Font: =Font.'Segoe UI'
                  Height: =47
                  Size: =18
                  Width: =343
                  X: =217
                  Y: =108
            - lblMapDesk_4:
                Control: Label@2.5.1
                Properties:
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Semibold
                  Text: ="From"
                  Width: =250
                  X: =61
            - tbMapDesk_3:
                Control: Classic/TextInput@2.3.2
                Properties:
                  AccessibleLabel: ="Map Link Input"
                  BorderColor: =RGBA(179, 179, 179, 1)
                  BorderThickness: =1
                  Default: =varSelectedReservation.'Check Out From'
                  Font: =Font.'Segoe UI'
                  Size: =18
                  Width: =250
                  X: =145
            - lblDescrDesk_3:
                Control: Label@2.5.1
                Properties:
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Semibold
                  Height: =55
                  Text: ="Description"
                  Width: =290
                  Y: =223
            - tbDescrDesk_3:
                Control: Classic/TextInput@2.3.2
                Properties:
                  AccessibleLabel: ="Desk Description Input"
                  BorderColor: =RGBA(179, 179, 179, 1)
                  BorderThickness: =1
                  Default: |-
                    =

                    varSelectedReservation.'Reason for desk reservation'
                    //LookUp(Desks,Title = varSelectedReservation.DeskText).Description
                  Font: =Font.'Segoe UI'
                  Height: =111
                  Mode: =TextMode.MultiLine
                  Size: =18
                  Width: =493
                  X: =181
                  Y: =234
            - btnUpdate_2:
                Control: Classic/Button@2.2.0
                Properties:
                  Fill: =RGBA(184, 0, 0, 1)
                  HoverFill: =ColorFade(Self.Fill, -20%)
                  OnSelect: =UpdateContext({varConfirmCancel:true});Set(varCancelContainer, false)
                  Text: ="CANCEL"
                  Visible: =false
                  Width: =260
                  X: =512
                  Y: =345
            - btnBackDeskEdit_3:
                Control: Classic/Button@2.2.0
                Properties:
                  Fill: =RGBA(128, 128, 128, 1)
                  HoverFill: =ColorFade(Self.Fill, -20%)
                  OnSelect: |-
                    =Reset(tbDescrDesk_3);
                    Reset(tbFloorDesk_4);
                    Reset(tbMapDesk_3);
                    Reset(tbNameDesk_3);
                    Set(varCancelContainer, false)
                  Text: ="Back"
                  Width: =200
                  X: =130
                  Y: =345
            - lblToRes_1:
                Control: Label@2.5.1
                Properties:
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Semibold
                  Text: ="To"
                  Width: =250
                  X: =400
            - tbTo_1:
                Control: Classic/TextInput@2.3.2
                Properties:
                  AccessibleLabel: ="Map Link Input"
                  BorderColor: =RGBA(179, 179, 179, 1)
                  BorderThickness: =1
                  Default: =varSelectedReservation.'Check Out To'
                  Font: =Font.'Segoe UI'
                  Size: =18
                  Width: =250
                  X: =446
            - lblReservedOn_1:
                Control: Label@2.5.1
                Properties:
                  Font: =Font.'Segoe UI'
                  FontWeight: =FontWeight.Semibold
                  Height: =39
                  Text: ="Reserved On"
                  Width: =254
                  Y: =70
            - tbReservedOn_1:
                Control: Classic/TextInput@2.3.2
                Properties:
                  AccessibleLabel: ="Map Link Input"
                  BorderColor: =RGBA(179, 179, 179, 1)
                  BorderThickness: =1
                  Default: =varSelectedReservation.Created
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Font: =Font.'Segoe UI'
                  Height: =38
                  Size: =18
                  Width: =250
                  X: =179
                  Y: =70
            - Rectangle3_13:
                Control: Rectangle@2.3.0
                Group: grpMap_8
                Properties:
                  Fill: =RGBA(116, 116, 116, 0.85)
                  Height: =415
                  Visible: =showMap
                  Width: =1022
            - Image5_10:
                Control: Image@2.2.3
                Group: grpMap_8
                Properties:
                  Height: =415
                  Image: =LookUp(Desks,Title = varSelectedReservation.DeskText).RoomPicture
                  ImagePosition: =ImagePosition.Stretch
                  Visible: =showMap
                  Width: =1022
            - Icon1_10:
                Control: Classic/Icon@2.5.0
                Group: grpMap_8
                Properties:
                  AccessibleLabel: ="Close Map"
                  Color: =RGBA(255, 255, 255, 1)
                  Height: =84
                  Icon: =Icon.Cancel
                  OnSelect: =UpdateContext({showMap:!showMap})
                  TabIndex: =11
                  Visible: =showMap
                  Width: =60
                  X: =962
      - Rectangle3_14:
          Control: Rectangle@2.3.0
          Group: grpConfirmCancel_2
          Properties:
            Fill: =RGBA(116, 116, 116, 0.85)
            Height: =292
            Visible: =varConfirmCancel
            Width: =804
            Y: =118
      - bgRounded_16:
          Control: HtmlViewer@2.1.0
          Group: grpConfirmCancel_2
          Properties:
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Font: =Font.'Open Sans'
            Height: =490
            HtmlText: ="<div style='border:1px gray;border-radius:10%;height:450px;width:100%;background-color:#FCFCFC'></div>"
            Size: =24
            Visible: =varConfirmCancel
            Width: =720
            X: =236
            Y: =150
      - Label1_3:
          Control: Label@2.5.1
          Group: grpConfirmCancel_2
          Properties:
            Align: =Align.Center
            FontWeight: =FontWeight.Semibold
            Height: =93
            Size: =24
            Text: ="Confirm Cancellation"
            Visible: =varConfirmCancel
            Width: =688
            X: =242
            Y: =262
      - btnConfirmCancel_3:
          Control: Classic/Button@2.2.0
          Group: grpConfirmCancel_2
          Properties:
            BorderThickness: =0
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(128, 128, 128, 1)
            Height: =72
            HoverFill: =ColorFade(Self.Fill, -20%)
            OnSelect: =UpdateContext({varConfirmCancel:false})
            RadiusBottomLeft: =20
            RadiusBottomRight: =20
            RadiusTopLeft: =20
            RadiusTopRight: =20
            Size: =14
            Text: ="NEVERMIND"
            Visible: =varConfirmCancel
            Width: =234
            X: =305
            Y: =505
      - btnConfirmDelete_3:
          Control: Classic/Button@2.2.0
          Group: grpConfirmCancel_2
          Properties:
            BorderThickness: =0
            Fill: =RGBA(184, 0, 0, 1)
            Height: =72
            HoverFill: =ColorFade(Self.Fill, -20%)
            OnSelect: |+
              =//Remove('Desk Reservations',varSelectedReservation);UpdateContext({varConfirmCancel:false});Back()
              // OnSelect property for the Confirm button
              If(
                  RadioGroupCanvas1.Selected.Value = "Series",
                  RemoveIf(
                      'Desk Reservations',
                      RecurrenceID = varSelectedReservation.RecurrenceID
                  ),
                  Remove(
                      'Desk Reservations',
                      varSelectedReservation
                  )
              );
              UpdateContext({varConfirmCancel: false});
            RadiusBottomLeft: =20
            RadiusBottomRight: =20
            RadiusTopLeft: =20
            RadiusTopRight: =20
            Size: =14
            Text: ="CONFIRM"
            Visible: =varConfirmCancel
            Width: =258
            X: =672
            Y: =505
      - RadioGroupCanvas1:
          Control: Radio@0.0.25
          Properties:
            Height: =80
            Items: =["This Reservation", "Series"]
            Visible: =varConfirmCancel
            X: =436
            Y: =343
      - TextCanvas1:
          Control: Text@0.0.51
          Properties:
            FontColor: =RGBA(255, 255, 255, 1)
            Height: =36
            Size: =16
            Text: ="Select Calendar View"
            VerticalAlign: =VerticalAlign.Middle
            Weight: ='TextCanvas.Weight'.Semibold
            Width: =154
            X: =802
            Y: =22
