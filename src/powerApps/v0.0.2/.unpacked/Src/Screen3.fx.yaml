Screen3 As screen:
    Fill: =Color.White
    LoadingSpinnerColor: =App.Theme.Colors.Primary
    OnVisible: |-
        =/*resets calendar view and date selection to today*/
                 
        Set(_dateSelected, Today());         
        Set(_firstDayOfMonth, DateAdd(Today(), 1 - Day(Today()), TimeUnit.Days));         
        Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));         
        Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
        Set(_calendarVisible,true);

    Group1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =6

        LblMonthSelected2_1 As label:
            Align: =Align.Center
            BorderColor: =App.Theme.Colors.Darker40
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Font: =App.Theme.Font
            Height: =68
            Size: =21
            Text: =Text(_firstDayOfMonth, "mmmm yyyy")
            Visible: =_calendarVisible
            Width: =641
            Wrap: =false
            X: =113
            Y: =132
            ZIndex: =1

        iconPrevMonth2_1 As icon.ChevronLeft:
            BorderColor: =App.Theme.Colors.Darker40
            Color: =App.Theme.Colors.Darker30
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Height: =68
            Icon: =Icon.ChevronLeft
            OnSelect: |-
                =/*changes month view to previous month*/
                           
                Set(_firstDayOfMonth, DateAdd(_firstDayOfMonth, -1, TimeUnit.Months));           
                Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));           
                Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));           
                /*collects calendar events for all days in current month view. Updates _minDate to prevent duplicate data collection if user returns to this month view*/           
                If(_minDate > _firstDayOfMonth, Set(_minDate, _firstDayInView))
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            TabIndex: =0
            Tooltip: ="View previous month"
            Visible: =_firstDayOfMonth > Today()
            Width: =85
            Y: =132
            ZIndex: =2

        iconNextMonth2_1 As icon.ChevronRight:
            BorderColor: =App.Theme.Colors.Darker40
            Color: =App.Theme.Colors.Darker30
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Height: =68
            Icon: =Icon.ChevronRight
            OnSelect: |-
                =/*changes month view to next month*/
                           
                Set(_firstDayOfMonth, DateAdd(_firstDayOfMonth, 1, TimeUnit.Months));           
                Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));           
                /*collects calendar events for all days in current month view. Updates _maxDate to prevent duplicate data collection if user returns to this month view*/           
                Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));           
                If(_maxDate < _lastDayOfMonth, Set(_maxDate, DateAdd(_firstDayInView, 40, TimeUnit.Days)))
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            TabIndex: =0
            Tooltip: ="View next month"
            Visible: =_calendarVisible
            Width: =126
            X: =742
            Y: =132
            ZIndex: =3

        WeekdayGallery2_1 As gallery.WeekdayGallery:
            '#CopilotOverlayLabel': ="Filtered"
            AccessibleLabel: ="Days of the week"
            BorderColor: =App.Theme.Colors.Darker40
            BorderThickness: =2
            Height: =65
            Items: =Calendar.WeekdaysLong()
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =126
            Visible: =_calendarVisible
            Width: =868
            Y: =200
            ZIndex: =4

            Title6_1 As label:
                Align: =Align.Center
                Color: =RGBA(0, 0, 0, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                Font: =App.Theme.Font
                OnSelect: =Select(Parent)
                Text: =ThisItem.Value
                Width: =124
                Wrap: =false
                Y: =10
                ZIndex: =1

        MonthDayGallery2_1 As gallery.MonthDayGallery:
            '#CopilotOverlayLabel': ="Filtered"
            AccessibleLabel: ="Days of selected month"
            BorderColor: =App.Theme.Colors.Darker40
            BorderThickness: =2
            Height: =374
            Items: =[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19, 20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]
            Layout: =Layout.Vertical
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =65
            Visible: =_calendarVisible
            Width: =868
            WrapCount: =7
            Y: =265
            ZIndex: =5

            Circle2_1 As circle:
                BorderColor: =App.Theme.Colors.Darker40
                Fill: =App.Theme.Colors.Lighter70
                Height: =20
                OnSelect: =Select(Parent)
                Visible: |-
                    =/*Visible if calendar events are found on this day*/               
                    //CountRows(Filter(MyCalendarEvents, DateValue(Text(Start)) = DateAdd(_firstDayInView,ThisItem.Value,Days))) > 0 && !Subcircle2_1.Visible && Title7_1.Visible
                    !IsBlank(LookUp('Desk Reservations','Check Out From' = DateAdd(_firstDayInView,ThisItem.Value,TimeUnit.Days)).'Reason for desk reservation')
                Width: =30
                X: =70
                Y: =45
                ZIndex: =1

            Subcircle2_1 As circle:
                BorderColor: =App.Theme.Colors.Darker40
                Fill: =App.Theme.Colors.Primary
                Height: =30
                OnSelect: =Select(Parent)
                Visible: =And(DateAdd(_firstDayInView, ThisItem.Value) = _dateSelected, Title7_1.Visible)
                Width: =38
                X: =62
                Y: =15
                ZIndex: =2

            Title7_1 As label:
                Align: =Align.Center
                BorderColor: =RGBA(0, 0, 0, 0)
                Color: =If(DateAdd(_firstDayInView, ThisItem.Value) = _dateSelected, RGBA(255, 255, 255, 1), DateAdd(_firstDayInView, ThisItem.Value) = Today(), RGBA(47, 41, 43, 1), LblMonthSelected2_1.Color)
                DisabledColor: =RGBA(166, 166, 166, 1)
                Fill: |-
                    =/*Fill value changes if the gallery item day = today, or if it lies outside of the current month*/             
                    If(
                        /*Date selected is today*/
                        DateAdd(_firstDayInView, ThisItem.Value) = Today() && DateAdd(_firstDayInView, ThisItem.Value) = _dateSelected, RGBA(0,0,0,0),
                        /*Today when it is not selected*/
                        DateAdd(_firstDayInView, ThisItem.Value) = Today(), ColorFade(Subcircle2_1.Fill, 0.67), 
                        /*The day is outside the range of the currently selected month*/
                        Abs(Self.Text - ThisItem.Value) > 10,RGBA(200, 200, 200, 0.3), RGBA(0, 0, 0, 0))
                FocusedBorderColor: =Self.Color
                FocusedBorderThickness: =2
                Font: =App.Theme.Font
                Height: =65
                OnSelect: =Set(_dateSelected, DateAdd(_firstDayInView, ThisItem.Value, TimeUnit.Days))
                Size: =15
                TabIndex: =0
                Text: =Day(DateAdd(_firstDayInView, ThisItem.Value, TimeUnit.Days))
                Visible: |-
                    =/*This item is in a row containing no days of the visible month. It is in the row after the row where the last day of the month occurs*/ 
                     !(DateAdd(_firstDayInView,ThisItem.Value,TimeUnit.Days) - Weekday(DateAdd(_firstDayInView,ThisItem.Value,TimeUnit.Days)) + 1 > _lastDayOfMonth)
                Width: =162.28571428571428
                Wrap: =false
                ZIndex: =3

