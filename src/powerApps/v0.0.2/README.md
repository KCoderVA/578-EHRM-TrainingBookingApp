# Power Apps (Canvas): EHRM Training & Booking App (Station #578)

**Canvas app version**: v0.0.2 (2026-01-02)
**App package**: `.msapp/v0.0.2_578EHRMTrainingApp.msapp`

## Provenance / credits (v0.0.1 baseline)
- The initial `.msapp` used as the starting point for this project (v0.0.1) was shared by **Hiram A. Zayas** (Hiram.Zayas@va.gov), Health Informatics Service, Battle Creek VA Medical Center.
- The connected SharePoint list sample data (sanitized) is stored locally under `src/sharePoint/lists/`.

## What changed in v0.0.2
- Fixed/updated SharePoint list data source bindings after importing into this environment (updates in `.unpacked/Connections/Connections.json` and `.unpacked/DataSources/`).
- Screen customizations focused on better auto-population and lookup behavior using M365/Active Directory and SharePoint list data:
    - `Dashboard` (minor updates)
    - `MyAppts` (dynamic list/form behaviors)
    - `POCSUPERVISOR` (largest set of updates)
    - `chkWeekDays` (dynamic weekday selection/inputs)
- Minor fixes across other screens to resolve importation errors.
- Validation: tested by submitting booking requests and confirming they populated correctly into the SharePoint list and remained viewable/interactive after refresh.

## Artifacts in this folder
- `.zip/578EHRMTrainingApp.zip`
    - Export artifact downloaded from the Power Apps web editor.
    - This repoâ€™s `.gitignore` contains `*.zip`, so this export is intentionally treated as a local artifact (not committed).
- `.msapp/v0.0.2_578EHRMTrainingApp.msapp`
    - The raw Canvas app package used as the input/output for packing and unpacking.
- `.unpacked/`
    - The unpacked, reviewable source generated by Power Platform CLI.

## 1. App Overview
- **App Type**: Phone
- **Orientation**: landscape
- **Connectors**:
    - Office 365 Outlook
    - Office 365 Users
    - SharePoint
- **Data Sources**:
    - **SharePoint**:
        - Desk Reservations
        - DeskAccessControl
        - Desks
    - **Office 365 Outlook**:
        - Actions: CalendarGetTables, V3CalendarPostItem, V2CalendarPostItem, FindMeetingTimes, GetRoomLists, GetRooms, GetRoomsInRoomList
    - **Office 365 Users**:
        - Actions: SearchUser

## 2. Screens
The application is composed of the following screens, in order of appearance:
1.  `Dashboard`
2.  `MyAppts`
3.  `POCSUPERVISOR`
4.  `chkWeekDays`
5.  `DeskSelect`
6.  `Confirm`
7.  `Success`
8.  `ManageDesks`
9.  `NewDesk`
10. `NewEditDesk`
11. `Reservation`
12. `SuccessDeskMod`
13. `ReleaseNotes`
14. `Screen3`
15. `scrn_MoCalendar`
16. `scrn_WeeklyCal`
17. `scrn_WeeklyCal_1`
18. `DebuggingScreen`
19. `Screen1`
20. `PDFScreen`
21. `Screen2`

## 3. ALM workflow (pack/unpack)
Use the VS Code tasks in this repo, or run Power Platform CLI directly:

- Unpack: `pac canvas unpack --msapp "<path-to-msapp>" --source "<path-to-unpacked>" --force`
- Pack: `pac canvas pack --msapp "<path-to-msapp>" --sources "<path-to-unpacked>"`
